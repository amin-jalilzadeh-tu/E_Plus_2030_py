Our workflow integrates the NTA 8800 methodology into an automated pipeline for assigning infiltration, ventilation flows, and associated parameters to building energy simulations. This pipeline consists of several modules that collectively transform building input data (such as function type, age range, perimeter, user overrides) into infiltration and ventilation objects within EnergyPlus IDF files. The objective is to remain faithful to NTA 8800’s approach for ventilation and infiltration, while also allowing more flexible, scenario-based calibrations.

We begin by extracting a building’s metadata (for example, building_function, age_range, perimeter, floor area) from a dataset. Once we have these fields, we convert them into the short keys or references used within our script. According to NTA 8800 Section 11.2.5 and other infiltration provisions, infiltration is often characterized at a uniform pressure difference of 10 Pa. However, the infiltration rate in actual calculations must be determined at 1 Pa, so the code must convert from the measured or estimated qv₁₀ to qv₁. We accomplish this using the relationship qv₁ = qv₁₀ × (1/10)ⁿ, where n is a flow exponent. NTA 8800 prescribes n = 0.67 for leak losses (i.e., infiltration). After applying this exponent-based reduction, we multiply the resulting qv₁ by the total floor area and then convert from m³/h to m³/s. This final infiltration value, infiltration_m³_s, is the base infiltration flow at typical operating conditions.

We also incorporate corrections for year of construction or renovation, which NTA 8800 references in sections describing the building’s air permeability factor. Our pipeline includes a “year_factor” that can adjust infiltration upward or downward for older or newer constructions. For example, in older buildings, the infiltration base might be multiplied by a factor of around 2.0 to 2.5, reflecting higher leakage typical of that era. Conversely, a more recent building or one built to high airtightness standards might only warrant a factor of around 1.1 or 1.0. Thus, infiltration_base multiplied by year_factor yields a refined qv₁₀, which we then reduce to qv₁ for final infiltration.

Once infiltration is determined, we calculate the required ventilation flow, in alignment with the relevant sections of NTA 8800 describing minimum outdoor airflow rates. Our code checks whether the building_function is residential or non_residential. For residential cases, we rely on an approximate base flow of 0.9 dm³/s per square meter of floor area, as an interpretation consistent with certain typical references in building codes. Then we apply a user-defined f_ctrl_val, typically corresponding to a system control factor. Multiplying the base flow by f_ctrl_val yields the final design flow, after which we ensure a minimum of around 126 m³/h, reflecting a typical lower limit for dwellings. Finally, this value is converted from m³/h to m³/s. For non_residential buildings, we map usage types such as office_area_based, childcare, or retail to typical design flows in dm³/s per m², again multiplied by f_ctrl_val. This approach matches the logic described in NTA 8800 for establishing design flows for different usage functions, though in simplified numeric form.

The pipeline next distributes infiltration and ventilation flows among all zones in the model. If a building has multiple EnergyPlus zones, we compute infiltration_m³_s_total and vent_flow_m³_s_total and then divide by the number of zones. This is consistent with the assumption that each zone receives a proportional share of infiltration and ventilation unless more specific geometry or infiltration data are available.

Once infiltration and ventilation flows are allocated, we generate or modify EnergyPlus objects. For infiltration, we create ZONEINFILTRATION:DESIGNFLOWRATE objects, setting the Design_Flow_Rate to infiltration_m³_s for each zone. This ensures infiltration is present in the simulation at the designated level. For ventilation, our system can create either a ZONEVENTILATION:DESIGNFLOWRATE object (for systems A, B, C) or modify a ZONEHVAC:IDEALLOADSAIRSYSTEM object (for system D). The underlying system classification (A, B, C, D) matches the categories enumerated by NTA 8800, namely Natural (A), Mechanical Supply with Natural Exhaust (B), Natural Supply with Mechanical Exhaust (C), or Balanced Mechanical with HRV (D).

When we encounter system D, we ensure there is an existing IdealLoads air system created for that zone. In NTA 8800, balanced mechanical ventilation with heat recovery typically implies certain heat exchange efficiencies. Therefore, if an hrv_eff parameter is computed or assigned by the user, we set that as the Sensible_Heat_Recovery_Effectiveness on the IdealLoads system. In code, we typically name this object “ZoneName Ideal Loads,” then set ideal_obj.Sensible_Heat_Recovery_Effectiveness = hrv_eff if it exists. This final step ensures that when the simulation runs, the zone is modeled with a sensible heat recovery capability matching the user’s or scenario’s assigned infiltration and ventilation overrides.

We also have a user configuration mechanism, allowing the pipeline to override defaults if certain parameters are specified. For instance, a user may define infiltration_base with min_val and max_val to force infiltration higher for testing or calibration. Similarly, system_type can be forced from “A” to “C” if the user wants mechanical exhaust in a building that is otherwise defaulting to natural ventilation. We do this by scanning a user_config list, which might specify param_name such as infiltration_base, year_factor, system_type, fan_pressure, f_ctrl, or hrv_eff. Once we locate matching overrides, we either convert them to a fixed_value or a (min_val, max_val) range and adjust the pipeline’s final results.

Throughout the process, we cross-reference the building’s scenario and calibration stage. NTA 8800 often prescribes different infiltration or ventilation factors in pre-calibration or post-calibration contexts, or we might have scenario1 vs. scenario2 for different sets of infiltration assumptions. Each scenario and calibration stage combination points to a different sub-dictionary that includes infiltration ranges, year factor ranges, system control factors, and so on.

Finally, we tie everything together by storing or logging the assigned infiltration_base, year_factor, system_type, fan_pressure, hrv_eff, and final infiltration/vent flows in a dictionary, possibly for diagnostic or traceability. Because we are working with a combination of references from NTA 8800 (particularly Sections 11.2.1 through 11.2.5 for infiltration, plus the basic ventilation principles in 11.2.2 for required outdoor air volume flow), the pipeline ensures that each building’s infiltration and ventilation reflect an NTA 8800–compatible approach. This includes the exponent of 0.67 for infiltration from 10 Pa to 1 Pa, recognized year-of-construction factors, usage-based airflow references, and if relevant, system type–dependent HRV efficiencies.

calc_infiltration does the essential math: infiltration_base × year_factor = qv₁₀, followed by qv₁ = qv₁₀ × (1/10)ⁿ, then multiplied by floor_area_m², and finally divided by 3600 to go from m³/h to m³/s. calc_required_ventilation_flow ensures that for residential, a base flow of 0.9 dm³/s/m² is used, with a forced minimum of 126 m³/h, and for non_res, we pick typical usage rates from usage_flow_map. The code also allows a control factor f_ctrl to multiply the nominal design flow. Overall, we remain consistent with the NTA 8800 approach, while customizing numeric constants for flexible, scenario-based modeling. The end result is a robust, automated means of translating building metadata, infiltration, and ventilation requirements into an EnergyPlus IDF that reflects, as closely as practical, the conceptual framework of NTA 8800.